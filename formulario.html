<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <title>Relatório de Trabalho Semanal</title>

    <style>
        * {
            box-sizing: border-box;
        }

        body {
            margin: 0;
            padding: 0;
            font-family: Arial, Helvetica, sans-serif;
            background-color: #ffffff;
            color: #000000;
        }

        .container {
            max-width: 900px;
            margin: 20px auto;
            padding: 20px;
            border: 2px solid #006400;
            border-radius: 10px;
        }

        .titulo {
            text-align: center;
            color: #006400;
            margin-bottom: 25px;
        }

        /* GRID RESPONSIVO */
        .form-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
        }

        .form-group {
            display: flex;
            flex-direction: column;
        }

        label {
            font-weight: bold;
            margin-bottom: 6px;
        }

        input, select {
            padding: 10px;
            border: 1px solid #000;
            border-radius: 6px;
            font-size: 15px;
            width: 100%;
        }

        input[type="number"] {
            text-align: center;
        }

        /* Campos que ocupam linha inteira */
        .full {
            grid-column: 1 / -1;
        }

        .btn-enviar {
            margin-top: 20px;
            padding: 12px;
            background-color: #006400;
            color: #ffffff;
            border: none;
            border-radius: 6px;
            font-size: 16px;
            cursor: pointer;
            width: 100%;
        }

        .btn-enviar:hover {
            background-color: #004d00;
        }

        /* MOBILE */
        @media (max-width: 600px) {
            .form-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>

<body>

    <div class="container">
        <h2 class="titulo">Relatório de Trabalho Semanal</h2>

        <form id="formulario">

            <div class="form-grid">

                <div class="form-group">
                    <label for="regiao">Região</label>
                    <select id="regiao"  onchange="atualizarIgrejas()" required>
                        <option value="">Selecione a região</option>
                    </select>
                </div>

                <div class="form-group">
                    <label for="igreja">Igreja</label>
                    <select id="igreja" required>
                        <option value="">Selecione a igreja</option>
                    </select>
                </div>

                <div class="form-group full">
                    <label for="nome">Nome de quem preencheu</label>
                    <input type="text" id="nome" name="nome" placeholder="Digite o nome">
                </div>

                <div class="form-group">
                    <label for="novos_titulos">Novos títulos</label>
                    <input type="number" id="novos_titulos" name="novos_titulos" min="0" required>
                </div>

                <div class="form-group">
                    <label for="titulos_transferidos">Títulos transferidos</label>
                    <input type="number" id="titulos_transferidos" name="titulos_transferidos" min="0" required>
                </div>

                <div class="form-group">
                    <label for="rg">Quantidade de RG</label>
                    <input type="number" id="rg" name="rg" min="0" required>
                </div>

                <div class="form-group">
                    <label for="cpf">Quantidade de CPF</label>
                    <input type="number" id="cpf" name="cpf" min="0" required>
                </div>

                <div class="form-group full">
                    <label for="outros_documentos">Outros documentos</label>
                    <input type="number" id="outros_documentos" name="outros_documentos" min="0" required>
                </div>

            </div>

            <button type="submit" class="btn-enviar">Enviar</button>

        </form>
    </div>

<script>
const API = "https://script.google.com/macros/s/AKfycbx1flJANfl84_6NvNdfKCH4ScSAuvlRUEJHDe5o5P_A2bgjnB3D96wedkkhYiVxaz5l/exec";

// carrega regiões
window.onload = () => {
  fetch(API + "?tipo=regioes")
    .then(r => r.json())
    .then(lista => {
      const select = document.getElementById("regiao");
      lista.forEach(r => {
        const opt = document.createElement("option");
        opt.value = r.id;
        opt.text = r.nome;
        select.add(opt);
      });
    });
};


// carrega igrejas conforme região
function atualizarIgrejas() {
  const regiaoId = document.getElementById("regiao").value;
  const igreja = document.getElementById("igreja");

  igreja.innerHTML = "<option value=''>Selecione</option>";

  if (!regiaoId) return;

  fetch(API + "?tipo=igrejas&regiao=" + regiaoId)
    .then(r => r.json())
    .then(lista => {
      lista.forEach(i => {
        const opt = document.createElement("option");
        opt.value = i.id;
        opt.text = i.nome;
        igreja.add(opt);
      });
    });
}


// envio do formulário
document.getElementById("formulario").addEventListener("submit", function(e) {
  e.preventDefault();

  fetch(API, {
    method: "POST",
    body: JSON.stringify({
      regiao: document.getElementById("regiao").value,
      igreja: document.getElementById("igreja").value,
      nome: document.getElementById("nome").value,
      novos_titulos: document.getElementById("novos_titulos").value,
      titulos_transferidos: document.getElementById("titulos_transferidos").value,
      rg: document.getElementById("rg").value,
      cpf: document.getElementById("cpf").value
    })
  })
  .then(() => alert("Dados enviados com sucesso!"))
  .catch(() => alert("Erro ao enviar"));
});

</script>
    
</body>
</html>
